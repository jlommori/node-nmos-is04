<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Node.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Node.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* Copyright 2016 Streampunk Media Ltd.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
*/

// Describes the Node and the services which run on it

// var Versionned = require('./Versionned.js');
// var Capabilities = require('./Capabilities.js');
var Resource = require('./Resource.js');
var os = require('os')
let _ = require('lodash')

/**
 * Instantiate a Node object. All params are optional, as any required items are generated automatically and optional items, such as services or api_endpoints, can be added after the node is created.
 * @extends Resource
 * @param {object} params       Object containing all Node parameters
 * @param {string} [params.id]         Inherited from {@link Resource}
 * @param {string} [params.version]         Inherited from {@link Resource}
 * @param {string} [params.label]         Inherited from {@link Resource}
 * @param {string} [params.description]         Inherited from {@link Resource}
 * @param {Object[]} [params.caps]         Inherited from {@link Resource}
 * @param {string[]} [params.tags]         Inherited from {@link Resource}
 * @param {string} [params.href]          HTTP access href for the Node's API (deprecated).
 * @param {Object[]} [params.services]      Array of objects containing a URN format type and href.
 * @param {Object[]} [params.clocks]        {@link Clocks} made available to Devices owned by this Node.
 * @param {(string | string[])} [params.interfaces]  Optional parameter to only include a specific interfaces or an array of interfaces. null returns all interfaces.
 */
class Node extends Resource {
  constructor(id, version, label, description, caps, tags, href, services, clocks, interfaces) {
    super(params.id, params.version, params.label, params.description, params.caps, params.tags)
    this.href = this.constructor.generateHref(params.href)
    this.api = this.constructor.generateAPI(this.constructor.generateInterfaces(params.interfaces))
    this.services = this.constructor.generateServices(params.services)
    this.clocks = this.constructor.generateClocks(params.clocks)
    this.interfaces = this.constructor.generateInterfaces(params.interfaces)
    this.hostname = ''
  }

  /**
   * generate Href for Node (deprecated in lieu of api, but still required as of dev v1.3). Auto updated when node server is spun up
   * @param  {string} href HTTP access href for the Node's API (deprecated).
   * @return {string}      HTTP access href for the Node's API (deprecated).
   */
  static generateHref(href) {
    if (arguments.length === 0 || href === null || href === undefined)
      return '';
    else return href;
  }

  /**
   * generate API object for Node. Auto updated when node server is spun up
   * @return {Object} Object with URL fragments required to connect to the Node API
   */
  static generateAPI(ifaces) {
    let endpoints = []
    _.each(ifaces, (iface) => {
      _.each(iface, (i) => {
        endpoints.push({
          host: i.address,
          protocol: "http"
        })
      })
    })
    return {
      versions: ["v1.1,v1.2"],
      endpoints: endpoints
    }
  }

  /**
   * generate services available on this Node
   * @param  {Object[]} [services] Array of objects containing a URN format type and href.
   * @return {Object[]}          Array of objects containing a URN format type and href.
   */
  static generateServices(services) {
    if (arguments.length === 0 || services === null || services === undefined)
      return [];
    else return services;
  }
  /**
   * genereate Clocks for this node
   * @param  {Object[]} [clocks] [Clocks]{@link clocks} Clocks made available to Devices owned by this Node.
   * @return {Object[]}        [Clocks]{@link clocks} Clocks made available to Devices owned by this Node.
   */
  static generateClocks(clocks) {
    if (arguments.length === 0 || clocks === null || clocks === undefined)
      return []
    else return clocks;
  }
  /**
   * [generateInterfaces description]
   * @param  {(string | string[])} [interfaces] Optional parameter to only include a specific interfaces or an array of interfaces. null returns all interfaces.
   * @return {object[]}            Network Interfaces made available to devices owned by this Node.
                                   Port Ids &amp; Chassis Ids are used to inform topology discoery via IS-06 and require
                                   that interfaces implement ARP at a minimum, and ideally LLDP.
   */
  static generateInterfaces(interfaces) {
    let networkInterfaces = {}
    if (typeof interfaces == 'string') {
      networkInterfaces[interfaces] = os.networkInterfaces()[interfaces]
      return networkInterfaces
    } else if (typeof interfaces == 'object') {
      interfaces.forEach((int) => {
        networkInterfaces[int] = os.networkInterfaces()[int]
      })
      return networkInterfaces
    } else {
      return os.networkInterfaces()
    }
  }

  //TODO: Add validation against JSON Schema from NMOS
  valid() {
    return true;
  }
}

module.exports = Node;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Node.html">Node</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Sep 02 2019 09:40:49 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
